지금까지는 커맨드라인 도구들을 모아서 강력한 무기고를 만들었다. 이러한 도구들로 수많은 시스템 문제들을 해결할 수 있었지만, 매번 일일이 커맨드라인에서 사용하는 데에는 한계가 있다. 우리가 설계한 프로그램에 커맨드라인 툴들을 모아놓으면 쉘이 스스로 복잡한 작업들을 순차적으로 수행할 수 있다. 이를 위해 우리는 쉘 스크립트를 작성한다.

1. 쉘 스크립트란?
쉘 스크립트는 명령어들이 나열되어 있는 파일이다. 쉘은 이 파일을 읽어서 마치 커맨드라인에 직접 명령어를 입력하여 실행하는 것처럼 수행한다. 쉘은 시스템의 강력한 커맨드라인 인터페이스라는 점과 스크립트 언어 인터프리터라는 점에서 조금 독특하다.

2. 쉘 스크립트 작성 방법
  1) 스크립트 작성하기
    쉘 스크립트는 일반적인 텍스트 파일이다. 따라서 텍스트 편집기가 필요하다. 스크립트를 작성할 때 vim, gedit, kate등 다양한 편집기를 사용할 수 있다.
  2) 스크립트를 실행파일로 설정하기
    시스템은 여러 이유들로 예전 텍스트 파일들을 프로그램으로 처리하지 않는다. 따라서 스크립트 파일에 실행 권한을 주어야 한다.
  3) 쉘이 접근할 수 있는 장소에 저장하기
    쉘은 경로명이 명시되어 있지 않아도 실행 가능한 파일들이 존재하는 특정 디렉토리를 자동으로 검색한다. 우리는 최대한의 편의를 위해 이 디렉토리에 작업한 스크립트를 저장할 것이다.

3. 실습
  1) 스크립트 파일 포맷

    #!/bin/bash

    # This is our first script.

    echo 'Hello World!'

    일반적으로 #은 주석을 의미하지만, #!은 shebang이라는 조합이다.
    shebang은 뒤따라오는 스크립트를 실행하기 위한 인터프리터의 이름을 시스템에 알려준다. 모든 쉘 스크립트의 첫 줄에는 shebang이 반드시 포함되어야 한다.

  2) 실행 퍼미션

    chmod 755 hello_world
    혹은
    chmod u+x,go=rx hello_world

    주의할 점은, 실행을 위해서는 항상 읽기 권한이 설정되어야 한다!

  3) 파일 저장 위치

    ./hello_world

    우리는 11장에서 PATH 환경 변수와 시스템이 실행 프로그램을 검색하는 데 있어 어떤 역할을 하는지 알아보았다. 다시 요약해보자면 경로명이 지정되어 있지 않다면, 시스템은 실행 프로그램을 찾을 때마다 디렉토리 목록을 검색한다. 이것은 우리가 ls 명령어를 입력할 때, 시스템이 어떻게 /bin/ls 디렉토리를 실행하는지를 말해준다. /bin 디렉토리는 시스템이 자동 검색하는 디렉토리 중 하나다. 디렉토리 목록은 PATH라고 하는 환경 변수에 규정되어 있다.
    echo $PATH

    홈 디렉토리에 bin 폴더를 만들고 그 곳에 프로그램을 넣으면 이제 어디에서든 실행할 수 있다.
    만약 PATH 변수에 bin 디렉토리가 포함되어 있지 않다면 .bashrc 파일에 다음의 내용을 입력한다
    export PATH=~/bin:"$PATH"

    이렇게 설정하고 나면 새로운 터미널 세션이 시작될 때마다 이 설정이 적용된다.

    마침표(.)명령어는 source 명령어와 동일하다
    . .bashrc 혹은 source .bashrc를 통해 업데이트된 내용을 적용시켜준다.

    ~/bin 디렉토리는 개인적인 용도로 사용하려는 스크립트를 저장하기에 좋은 장소이다
    /usr/local/bin 은 모든 사용자가 접근 가능한 스크립트
    /usr/local/sbin은 시스템 관리자용 스크립트
    대부분의 경우 시스템에서 사용되는 소프트웨어는 /usr/local에 저장되어야 한다.



4. 기타 포맷 방법
중요한 스크립트를 작성할 때 주요 목표 중 하나가 바로 유지보수의 용이성이다. 즉 스크립트 원작자나 다른 사람들이 스크립트를 수정할 때 그 수정사항이 쉽게 반영되도록 하는 것이다.

  1) 확장 옵션명(long 옵션명)
  타이핑을 적게 하기 위해서는 축약형을 쓰지만, 스크립트 작성 시에는 되도록 확장형을 사욯한다

  2) 들여쓰기 및 문장 연결
  스크립트에서는 가독성을 위해 tab을 많이 사용하도록 한다.
  
